%h4.subtitle#ungradedTableCaption
  = "Ungraded #{term_for :assignment} Submissions"
  %span.label.alert= ungraded_submissions_count_for(course)

- @ungraded_submissions_by_assignment.each do |assignment, submissions|
  %h4.assignment_name
    = link_to assignment.name, assignment
    = link_to glyph(:check) + "Quick Grade", mass_edit_assignment_grades_path(assignment), class: "button"
  %table.dynatable{"aria-describedby" => "ungradedTableCaption"}
    %thead
      %tr
        - if assignment.is_individual?
          %th{scope: "col", :width => "7%"} First Name
          %th{scope: "col", :width => "7%"} Last Name
          - if course.has_teams?
            %th{scope: "col", :width => "15%"}= "#{term_for :team}"
        - elsif assignment.has_groups?
          %th{scope: "col"} Group
        %th Date Submitted
        %th{scope: "col", :style => "min-width: 200px"}
          %span.sr-only Actions
    %tbody
      - submissions.each do |submission|
        - student = submission.student
        - team = student.team_for_course(course) if student
        - group = submission.group
        %tr
          - if assignment.is_individual?
            %td= link_to student.first_name, student_path(student)
            %td= link_to student.last_name, student_path(student)
            %td
              - if course.has_teams? && student.present? && team.present?
                = link_to team.name, team
          - elsif assignment.has_groups?
            %td= link_to group.try(:name), group_path(group)
          %td= submission.submitted_at
          %td
            .right
              %ul.button-bar
                - if assignment.is_individual?
                  %li= link_to glyph(:eye) + "See Submission", assignment_submission_path(assignment, id: submission.id), class: "button"
                  %li= link_to glyph(:check) + "Grade", edit_assignment_grade_path(assignment_id: assignment.id, student_id: student.id), class: "button"
                - elsif assignment.has_groups?
                  %li= link_to glyph(:eye) + "See Submission", assignment_submission_path(assignment.id, id: submission.id), class: "button"
                  %li= link_to glyph(:check) + "Grade", grade_assignment_group_path(assignment, group), class: "button"
  %hr.dotted
